<html>
<head>
<title>v1.8.1</title>
<meta http-equiv=Content-Type content="text/html; charset=gbk">
<link rel="stylesheet" href="../public/css/Word2Chm.css" type="text/css">
<link rel="stylesheet" href="../public/css/default.css" type="text/css" />
<link rel="stylesheet" href="../public/css/noframe.css" type="text/css" />
<link rel="stylesheet" href="../public/css/bootstrap.css" type="text/css" />
</head>
<body>
    <div class="wiki_content">
        <article class="markdown-body entry-content">
            <h1>1.8.1</h1>
            
           <h2>主要更新</h2>

            <ul>
                <li>增加核心类的命名空间别名</li>
                <li>增加<code>swoole_server-&gt;protect</code>方法，用于保护某些连接不被心跳线程切断</li>
                <li>增加<code>swoole_websocker_server::pack</code>和<code>swoole_websocker_server::unpack</code>静态方法，用于手工打包/解包websocket数据帧</li>
                <li>修复日志打印标准输出被关闭不断产生<code>SIGPIPE</code>信号导致死循环的问题</li>
                <li>修复<code>MacOS</code>环境下启用<code>openssl</code>编译失败的问题</li>
                <li>增加对<code>redis</code>订阅和发布消息的支持</li>
                <li>修复多端口监听未设置监听端口回调发生core dump的问题</li>
                <li>修复异步Client发生内存泄漏的问题</li>
                <li>修复在其他事件回调函数中关闭异步Client偶然发生core dump的问题</li>
                <li>增加<code>swoole_http_client</code>对<code>gzip</code>内容压缩的支持</li>
            </ul>
            
            <h2>命名空间示例</h2>
            
            <blockquote>
              <p>使用命名空间类风格，需要修改<code>php.ini</code>，增加<code>swoole.use_namespace=On</code>开启。使用命名空间类名后，旧式的下划线风格类名将不可用</p>
            </blockquote>
            
            <pre>use Swoole\Http\Server;
use Swoole\Http\Request;
use Swoole\Http\Response;

$serv = new Server('127.0.0.1', 9501);

$serv-&gt;on('Request', function(Request $req, Response $resp) {
    var_dump($req-&gt;header, get_class($req));
    $resp-&gt;end("&lt;h1&gt;Hello Swoole&lt;/h1&gt;");
});

$serv-&gt;start();
</pre>
        </article>
        
    </div>
</body>
</html>
